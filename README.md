# Модель облачного приложения с Autoscaling

Курсовая работа по дисциплине "Имитационное моделирование дискретных процессов".

## Описание

Приложение для имитационного моделирования облачного хранилища (облачного сервиса) с динамическим масштабированием нагрузки. Модель реализована с использованием библиотеки SimPy для дискретно-событийного моделирования и PyQt6 для графического интерфейса.

## Основные возможности

- **Дискретно-событийное моделирование** облачного приложения с очередями запросов
- **Динамическое автомасштабирование** количества серверных узлов в зависимости от нагрузки
- **Реактивный пороговый контроллер** с гистерезисом для стабильного масштабирования
- **Графики в реальном времени** (длина очереди, количество узлов, время отклика)
- **Сбор метрик** (среднее время отклика, доля отказов, соответствие SLA)
- **Визуализация системы** с динамическим отображением состояния

## Архитектура проекта

```
cloud-load-model/
├── model/                  # Модуль моделирования
│   ├── core.py            # Основные классы: Request, StorageNode, CloudSystemModel
│   ├── load_balancer.py   # Балансировщик нагрузки (round-robin)
│   ├── autoscaler.py      # Контроллер автомасштабирования
│   └── metrics.py         # Сборщик метрик
├── ui/                     # Модуль пользовательского интерфейса
│   ├── main_window.py     # Главное окно приложения
│   ├── settings_panel.py  # Панель настроек параметров
│   ├── plots_widget.py    # Виджет с графиками (pyqtgraph)
│   ├── stats_widget.py    # Виджет со статистикой
│   ├── visualization.py   # Визуальная схема системы
│   └── simulation_thread.py # Поток симуляции (интеграция SimPy и PyQt)
├── utils/                  # Утилиты
├── run_app.py             # Точка входа в приложение
└── requirements.txt       # Зависимости проекта
```

## Основные компоненты модели

### 1. CloudSystemModel (model/core.py)

Основная модель системы, которая:
- Генерирует входящие запросы с экспоненциальным распределением межприходных интервалов
- Управляет очередью запросов
- Управляет пулом серверных узлов
- Учитывает сетевые задержки
- Поддерживает ограничение пропускной способности

### 2. AutoScaler (model/autoscaler.py)

Контроллер автомасштабирования с пороговой логикой:
- **Периодический анализ метрик** (длина очереди, время отклика)
- **Пороги масштабирования**: `low_threshold` и `high_threshold`
- **Гистерезис**: требует несколько последовательных интервалов с низкой нагрузкой для уменьшения масштаба
- **Cooldown**: минимальное время между операциями масштабирования для предотвращения "дёргания"

**Логика масштабирования:**
- Если `queue_length > high_threshold` или `avg_response_time > high_threshold` и `nodes < max_nodes` → добавить узел
- Если показатели стабильно `< low_threshold` в течение нескольких интервалов и `nodes > min_nodes` → удалить узел

### 3. LoadBalancer (model/load_balancer.py)

Балансировщик нагрузки, распределяющий запросы по узлам по алгоритму round-robin.

### 4. MetricsCollector (model/metrics.py)

Сборщик метрик, который собирает:
- **Временные ряды**: длина очереди, количество узлов, среднее время отклика
- **Агрегированные метрики**: среднее/максимальное время отклика, средняя/максимальная длина очереди, количество обработанных/отклоненных запросов, доля запросов в SLA

## Установка и запуск

### Требования

- Python 3.8 или выше
- pip

### Установка зависимостей

```bash
pip install -r requirements.txt
```

Зависимости:
- `simpy >= 4.0.1` - библиотека для дискретно-событийного моделирования
- `PyQt6 >= 6.6.0` - фреймворк для GUI
- `pyqtgraph >= 0.13.3` - библиотека для графиков в реальном времени
- `numpy >= 1.24.0` - библиотека для численных вычислений

### Запуск приложения

```bash
python run_app.py
```

## Использование

### Настройка параметров модели

В левой панели можно настроить следующие параметры:

**Параметры нагрузки:**
- λ (интенсивность потока) - количество запросов в единицу времени
- Время обработки (мин/макс) - диапазон времени обработки одного запроса

**Параметры сети:**
- Задержка сети (мин/макс) - диапазон сетевых задержек
- Макс. запросов - ограничение на количество одновременно обрабатываемых запросов

**Автомасштабирование:**
- Мин./Макс. узлов - границы масштабирования
- Начальных узлов - начальное количество узлов
- Нижний/Верхний порог - пороги для принятия решений о масштабировании
- Интервал контроля - частота проверки метрик
- Cooldown - минимальное время между операциями масштабирования

**Симуляция:**
- Длительность - длительность моделирования в единицах моделируемого времени

### Управление симуляцией

- **Старт** - запускает симуляцию с текущими параметрами
- **Пауза** - приостанавливает симуляцию
- **Продолжить** - возобновляет приостановленную симуляцию
- **Стоп** - останавливает симуляцию
- **Сброс** - сбрасывает все графики и статистику

### Просмотр результатов

**Вкладка "Графики":**
- График длины очереди vs время
- График количества активных узлов vs время
- График среднего времени отклика vs время

**Вкладка "Статистика":**
- Итоговые агрегированные метрики:
  - Всего запросов / Обработано / Отклонено
  - Среднее/Максимальное/Минимальное время отклика
  - Средняя/Максимальная длина очереди
  - Доля отказов (%)
  - Соответствие SLA (%)

**Вкладка "Визуализация":**
- Схематическое отображение системы: Клиенты → Очередь → Серверы
- Динамическое обновление количества узлов
- Текущие показатели системы

## Интерпретация метрик

### Время отклика
- **Среднее время отклика** - среднее время от момента поступления запроса до завершения обработки
- **Максимальное время отклика** - максимальное время отклика среди всех запросов
- Низкое время отклика указывает на хорошую производительность системы

### Длина очереди
- **Средняя длина очереди** - среднее количество запросов, ожидающих обработки
- **Максимальная длина очереди** - пиковая нагрузка на систему
- Высокая длина очереди может указывать на недостаточное количество узлов

### Соответствие SLA
- Доля запросов, обработанных в пределах заданного порога времени отклика
- Высокий процент соответствия SLA указывает на стабильную работу системы

### Автомасштабирование
- Наблюдайте за графиком количества узлов - он должен динамически изменяться в зависимости от нагрузки
- При увеличении нагрузки количество узлов должно расти
- При снижении нагрузки (после периода стабильности) количество узлов должно уменьшаться

## Технические детали

### Распределения
- **Межприходные интервалы**: экспоненциальное распределение (пуассоновский поток)
- **Время обработки**: равномерное распределение в заданном диапазоне
- **Сетевые задержки**: равномерное распределение в заданном диапазоне

### Потокобезопасность
- Симуляция выполняется в отдельном потоке (QThread)
- Данные передаются в GUI через сигналы PyQt (pyqtSignal)
- Интерфейс остается отзывчивым во время симуляции

## Лицензия

Проект создан в учебных целях для курсовой работы.

## Автор

Разработано для курсовой работы по дисциплине "Имитационное моделирование дискретных процессов".
